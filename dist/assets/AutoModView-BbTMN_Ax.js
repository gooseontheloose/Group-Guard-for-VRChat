import{r as b,j as e,G as w,A,m as p,d as B,u as D,g as M}from"./index-D5E0sjoJ.js";import{u as P}from"./auditStore-CZ6szYLB.js";const W=({active:i,label:o,icon:r,onClick:s})=>e.jsxs("button",{onClick:s,style:{position:"relative",background:"transparent",border:"none",padding:"12px 24px",color:i?"white":"var(--color-text-dim)",fontWeight:800,fontSize:"0.9rem",letterSpacing:"0.05em",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.3s ease",outline:"none",zIndex:1},children:[e.jsx("span",{style:{fontSize:"1.2rem",opacity:i?1:.7},children:r}),o,i&&e.jsx(p.div,{layoutId:"activeTab",style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"var(--color-primary)",boxShadow:"0 -2px 10px var(--color-primary)",borderRadius:"2px"}}),i&&e.jsx(p.div,{layoutId:"activeTabBg",style:{position:"absolute",inset:0,background:"linear-gradient(to top, rgba(var(--primary-hue), 100%, 50%, 0.1) 0%, transparent 100%)",borderRadius:"8px 8px 0 0",zIndex:-1}})]}),z=({value:i,onChange:o,placeholder:r,label:s,color:n="var(--color-primary)"})=>{const[m,y]=b.useState(""),j=d=>{if(d.key==="Enter"||d.key===","){d.preventDefault();const h=m.trim();h&&!i.includes(h)&&(o([...i,h]),y(""))}else d.key==="Backspace"&&!m&&i.length>0&&o(i.slice(0,-1))},l=d=>{o(i.filter(h=>h!==d))};return e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"var(--color-text-dim)",marginBottom:"0.5rem"},children:s}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",padding:"8px",background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",minHeight:"42px"},children:[i.map(d=>e.jsxs(p.div,{layout:!0,style:{background:n==="red"?"rgba(239, 68, 68, 0.2)":"rgba(74, 222, 128, 0.2)",border:`1px solid ${n==="red"?"#ef4444":"#4ade80"}`,color:n==="red"?"#fca5a5":"#86efac",padding:"2px 8px",borderRadius:"4px",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[d,e.jsx("span",{onClick:()=>l(d),style:{cursor:"pointer",opacity:.7,fontWeight:"bold"},children:"×"})]},d)),e.jsx("input",{type:"text",value:m,onChange:d=>y(d.target.value),onKeyDown:j,placeholder:i.length===0?r:"",style:{background:"transparent",border:"none",color:"white",fontSize:"0.9rem",flex:1,minWidth:"60px",outline:"none"}})]})]})},O=({isOpen:i,onClose:o,config:r,onUpdate:s})=>M.createPortal(e.jsx(A,{children:i&&e.jsx(e.Fragment,{children:e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:"50px"},children:e.jsx(p.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:n=>n.stopPropagation(),style:{width:"90%",maxWidth:"1000px",maxHeight:"80vh",zIndex:101,display:"flex",flexDirection:"column",overflow:"hidden",borderRadius:"12px"},children:e.jsxs(w,{style:{padding:"0",border:"1px solid rgba(239, 68, 68, 0.3)",boxShadow:"0 0 30px rgba(239, 68, 68, 0.1)",display:"flex",flexDirection:"column",height:"100%",maxHeight:"100%",minHeight:0},children:[e.jsxs("div",{style:{padding:"1.5rem 1.5rem 1rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid rgba(255,255,255,0.05)",flexShrink:0},children:[e.jsxs("h2",{style:{margin:0,fontSize:"1.25rem",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{padding:"8px",background:"rgba(239, 68, 68, 0.1)",borderRadius:"50%",color:"#f87171"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),"Keyword Filter Configuration"]}),e.jsx("button",{onClick:o,style:{background:"none",border:"none",color:"var(--color-text-dim)",cursor:"pointer",fontSize:"1.5rem",display:"flex"},children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{style:{padding:"1.5rem",overflowY:"auto",flex:"1 1 auto",minHeight:0,display:"grid",gridTemplateColumns:"1.4fr 1fr",gap:"2rem",alignItems:"start"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[e.jsxs("div",{children:[e.jsx(z,{label:"Blocked Keywords",placeholder:"Add word to ban...",value:r.keywords||[],color:"red",onChange:n=>s({...r,keywords:n})}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)",marginTop:"-8px",paddingLeft:"4px"},children:[e.jsx("span",{style:{color:"#fca5a5"},children:"Pro Tip:"}),' To block an acronym (like "D.I.D") without banning the word "did", enter it with periods: ',e.jsx("strong",{children:"d.i.d"})]})]}),e.jsx(z,{label:"Safelist (Exceptions)",placeholder:"Add allowed word...",value:r.whitelist||[],color:"green",onChange:n=>s({...r,whitelist:n})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem",background:"rgba(0,0,0,0.2)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"bold",color:"var(--color-text-dim)",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Scanning Fields"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[{k:"scanBio",l:"Bio"},{k:"scanStatus",l:"Status"},{k:"scanPronouns",l:"Pronouns"}].map(n=>e.jsxs("div",{onClick:()=>s({...r,[n.k]:!r[n.k]}),style:{padding:"6px 12px",borderRadius:"6px",background:r[n.k]?"rgba(74, 222, 128, 0.1)":"rgba(255,255,255,0.05)",border:r[n.k]?"1px solid #4ade80":"1px solid rgba(255,255,255,0.1)",color:r[n.k]?"white":"var(--color-text-dim)",fontSize:"0.8rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:r[n.k]?"#4ade80":"rgba(255,255,255,0.2)"}}),n.l]},n.k))})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"bold",color:"var(--color-text-dim)",marginBottom:"0.8rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Matching Strategy"}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)",marginBottom:"1rem",fontStyle:"italic",background:"rgba(255,255,255,0.05)",padding:"8px",borderRadius:"4px",display:"flex"},children:["Example: Blocked ",e.jsx("strong",{style:{color:"#f87171",margin:"0 4px"},children:'"bad"'})," & ",e.jsx("strong",{style:{color:"#f87171",marginLeft:"4px"},children:'"lol"'})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{onClick:()=>s({...r,matchMode:"WHOLE_WORD"}),style:{padding:"1rem",borderRadius:"8px",background:r.matchMode!=="PARTIAL"?"rgba(74, 222, 128, 0.1)":"rgba(255,255,255,0.02)",border:r.matchMode!=="PARTIAL"?"1px solid #4ade80":"1px solid rgba(255,255,255,0.05)",cursor:"pointer",transition:"all 0.2s",opacity:r.matchMode!=="PARTIAL"?1:.6,display:"grid",gridTemplateColumns:"minmax(0, 1fr) minmax(0, 1fr)",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",color:r.matchMode!=="PARTIAL"?"#4ade80":"white",marginBottom:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",border:"2px solid currentColor",background:r.matchMode!=="PARTIAL"?"currentColor":"transparent"}}),"Strict (Whole Word)"]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)"},children:"Smartly handles acronyms."})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"8px",borderRadius:"6px",fontSize:"0.7rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"#d4d4d4"},children:'"badger"'}),e.jsx("span",{style:{fontWeight:"bold",color:"#4ade80"},children:"✓ Safe"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#d4d4d4"},children:'"l.o.l"'}),e.jsx("span",{style:{fontWeight:"bold",color:"#f87171"},children:"✖ Block"})]})]})]}),e.jsxs("div",{onClick:()=>s({...r,matchMode:"PARTIAL"}),style:{padding:"1rem",borderRadius:"8px",background:r.matchMode==="PARTIAL"?"rgba(239, 68, 68, 0.1)":"rgba(255,255,255,0.02)",border:r.matchMode==="PARTIAL"?"1px solid #ef4444":"1px solid rgba(255,255,255,0.05)",cursor:"pointer",transition:"all 0.2s",opacity:r.matchMode==="PARTIAL"?1:.6,display:"grid",gridTemplateColumns:"minmax(0, 1fr) minmax(0, 1fr)",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",color:r.matchMode==="PARTIAL"?"#f87171":"white",marginBottom:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",border:"2px solid currentColor",background:r.matchMode==="PARTIAL"?"currentColor":"transparent"}}),"Loose (Partial)"]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)"},children:"Matches everywhere."})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"8px",borderRadius:"6px",fontSize:"0.7rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"#d4d4d4"},children:'"badger"'}),e.jsx("span",{style:{fontWeight:"bold",color:"#f87171"},children:"✖ Block"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#d4d4d4"},children:'"l.o.l"'}),e.jsx("span",{style:{fontWeight:"bold",color:"#f87171"},children:"✖ Block"})]})]})]})]})]})]})]}),e.jsx("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"flex-end",background:"rgba(0,0,0,0.2)",flexShrink:0},children:e.jsx("button",{onClick:o,style:{padding:"10px 24px",background:"#f87171",color:"black",border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 12px rgba(248, 113, 113, 0.3)",fontSize:"0.9rem"},children:"Done"})})]})})})})}),document.body),N=({label:i,color:o="rgba(255,255,255,0.1)"})=>e.jsx("span",{style:{padding:"4px 10px",background:o,borderRadius:"4px",fontSize:"0.7rem",fontWeight:600,color:"white",textTransform:"lowercase",whiteSpace:"nowrap"},children:i}),_=i=>i?.some(o=>o.includes("trusted"))?"#a855f7":i?.some(o=>o.includes("known"))?"#f97316":i?.some(o=>o.includes("user"))?"#22c55e":i?.some(o=>o.includes("new_user"))?"#3b82f6":"#6b7280",K=i=>{if(!i||!Array.isArray(i))return[];const o=[];i.some(s=>s==="system_trust_veteran")&&o.push({label:"trust veteran",color:"rgba(168, 85, 247, 0.3)"}),i.some(s=>s==="system_trust_trusted")&&o.push({label:"trust trusted",color:"rgba(168, 85, 247, 0.3)"}),i.some(s=>s==="system_trust_known")&&o.push({label:"trust known",color:"rgba(249, 115, 22, 0.3)"}),i.some(s=>s==="system_trust_basic")&&o.push({label:"trust basic",color:"rgba(59, 130, 246, 0.3)"}),i.some(s=>s==="system_early_adopter")&&o.push({label:"early adopter",color:"rgba(236, 72, 153, 0.3)"}),i.some(s=>s==="system_supporter")&&o.push({label:"supporter",color:"rgba(34, 197, 94, 0.3)"}),i.some(s=>s.includes("feedback_access"))&&o.push({label:"feedback access",color:"rgba(99, 102, 241, 0.3)"}),i.some(s=>s.includes("world_access"))&&o.push({label:"world access",color:"rgba(99, 102, 241, 0.3)"}),i.some(s=>s.includes("avatar_access"))&&o.push({label:"avatar access",color:"rgba(99, 102, 241, 0.3)"});const r=i.find(s=>s.startsWith("language_"));if(r){const s=r.replace("language_","");o.push({label:`language ${s}`,color:"rgba(156, 163, 175, 0.3)"})}return o},G=({isOpen:i,onClose:o,logEntry:r,onActionComplete:s})=>{const[n,m]=b.useState(null),[y,j]=b.useState(!1),[l,d]=b.useState(null),h=B.useCallback(async()=>{if(r?.userId){j(!0);try{const a=await window.electron.getUser(r.userId);a?.success&&a?.user?m(a.user):(console.error("Failed to fetch user:",a?.error),m(null))}catch(a){console.error("Failed to fetch user",a),m(null)}j(!1)}},[r?.userId]);B.useEffect(()=>{i&&r?.userId?h():m(null)},[i,r?.userId,h]);const{selectedGroup:k}=D(),c=async(a,R=!0)=>{if(!r?.userId)return;const f=r.groupId||k?.id;if(!f||f==="grp_unknown"){alert("Could not determine which Group to perform this action for. Please ensure you have a Group selected in the Dashboard.");return}d(a);try{const t=window.electron;let g={success:!1};switch(a){case"invite":g=await t.instance.recruitUser(f,r.userId);break;case"unban":g=await t.instance.unbanUser(f,r.userId);break;case"kick":g=await t.instance.kickUser(f,r.userId);break;case"ban":g=await t.banUser(f,r.userId);break}g?.success?R&&(s(),o()):(console.error(`Action ${a} failed:`,g?.error),alert(`Action failed: ${g?.error||"Unknown error"}`))}catch(t){console.error(`Failed to perform action: ${a}`,t),alert(`Action failed: ${t instanceof Error?t.message:"Unknown error"}`)}d(null)};if(!i)return null;const x=r?.action||"BLOCKED",u=n?.tags?K(n.tags):[],C=n?.ageVerified===!0,S=n?.tags?.some(a=>a.includes("supporter")),I=n?.tags?_(n.tags):"#6b7280";return M.createPortal(e.jsx(A,{children:i&&e.jsx(e.Fragment,{children:e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(10px)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsx(p.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:a=>a.stopPropagation(),style:{width:"100%",maxWidth:"520px",maxHeight:"85vh",zIndex:10001,display:"flex",flexDirection:"column"},children:e.jsxs(w,{style:{padding:"0",border:`1px solid ${I}40`,boxShadow:`0 0 40px ${I}20`,overflow:"hidden",display:"flex",flexDirection:"column",maxHeight:"100%"},children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",background:"rgba(0,0,0,0.3)",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:y?"Loading...":n?.displayName||r?.user||"Unknown User"}),e.jsx("button",{onClick:o,style:{background:"rgba(255,255,255,0.1)",border:"none",color:"rgba(255,255,255,0.7)",cursor:"pointer",padding:"6px",borderRadius:"6px",display:"flex"},children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{style:{overflowY:"auto",flex:1},children:[e.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",backgroundImage:n?.currentAvatarThumbnailImageUrl?`url(${n.currentAvatarThumbnailImageUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",border:`2px solid ${I}`,flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:"1.15rem",fontWeight:700,color:"white"},children:n?.displayName||r?.user||"Unknown"}),n?.statusDescription&&e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.7)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.statusDescription})]})]}),u.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"1rem"},children:u.map((a,R)=>e.jsx(N,{label:a.label,color:a.color},R))}),e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[C&&e.jsx("span",{style:{background:"#ef4444",color:"white",padding:"4px 10px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold"},children:"18+"}),S&&e.jsx("span",{style:{background:"linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)",color:"white",padding:"4px 10px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold"},children:"supporter"}),n?.pronouns&&e.jsx("span",{style:{background:"rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.8)",padding:"4px 10px",borderRadius:"4px",fontSize:"0.75rem"},children:n.pronouns})]})]}),n?.bio&&e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid rgba(255,255,255,0.05)",background:"rgba(0,0,0,0.2)"},children:[e.jsx("div",{style:{fontSize:"0.7rem",fontWeight:"bold",color:"var(--color-text-dim)",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.05em"},children:"BIO"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"rgba(255,255,255,0.9)",lineHeight:1.6,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:n.bio})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:x==="BLOCKED"?"rgba(239, 68, 68, 0.1)":x==="ACCEPTED"?"rgba(74, 222, 128, 0.1)":"rgba(251, 191, 36, 0.1)",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx("span",{style:{width:"10px",height:"10px",borderRadius:"50%",background:x==="BLOCKED"?"#f87171":x==="ACCEPTED"?"#4ade80":"#fbbf24"}}),e.jsx("span",{style:{fontWeight:"bold",color:x==="BLOCKED"?"#f87171":x==="ACCEPTED"?"#4ade80":"#fbbf24",fontSize:"0.85rem",textTransform:"uppercase"},children:x})]}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.8)",marginBottom:"4px"},children:[e.jsx("strong",{children:"Reason:"})," ",r?.reason||"No reason recorded"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.5)"},children:r?.timestamp?new Date(r.timestamp).toLocaleString():"Unknown time"})]})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"rgba(0,0,0,0.3)",display:"flex",flexDirection:"column",gap:"0.5rem",flexShrink:0},children:[e.jsx("div",{style:{fontSize:"0.7rem",fontWeight:"bold",color:"var(--color-text-dim)",marginBottom:"0.25rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Reversal Actions"}),(x==="BLOCKED"||x==="REJECTED")&&e.jsxs("button",{onClick:()=>c("invite"),disabled:l!==null,style:{width:"100%",padding:"12px",background:"rgba(74, 222, 128, 0.15)",border:"1px solid #4ade80",color:"#4ade80",borderRadius:"8px",fontWeight:"bold",fontSize:"0.85rem",cursor:l?"wait":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:l&&l!=="invite"?.5:1,transition:"all 0.2s"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),e.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]}),l==="invite"?"Inviting...":"Invite to Group"]}),x==="BANNED"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c("unban"),disabled:l!==null,style:{width:"100%",padding:"12px",background:"rgba(251, 191, 36, 0.15)",border:"1px solid #fbbf24",color:"#fbbf24",borderRadius:"8px",fontWeight:"bold",fontSize:"0.85rem",cursor:l?"wait":"pointer",opacity:l&&l!=="unban"?.5:1},children:l==="unban"?"Unbanning...":"Unban User"}),e.jsx("button",{onClick:async()=>{await c("unban",!1),await c("invite",!0)},disabled:l!==null,style:{width:"100%",padding:"12px",background:"rgba(74, 222, 128, 0.15)",border:"1px solid #4ade80",color:"#4ade80",borderRadius:"8px",fontWeight:"bold",fontSize:"0.85rem",cursor:l?"wait":"pointer",opacity:l?.5:1},children:"Unban + Invite to Group"})]}),x==="ACCEPTED"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c("kick"),disabled:l!==null,style:{width:"100%",padding:"12px",background:"rgba(251, 191, 36, 0.15)",border:"1px solid #fbbf24",color:"#fbbf24",borderRadius:"8px",fontWeight:"bold",fontSize:"0.85rem",cursor:l?"wait":"pointer",opacity:l&&l!=="kick"?.5:1},children:l==="kick"?"Kicking...":"Kick from Group"}),e.jsx("button",{onClick:()=>c("ban"),disabled:l!==null,style:{width:"100%",padding:"12px",background:"rgba(239, 68, 68, 0.15)",border:"1px solid #ef4444",color:"#ef4444",borderRadius:"8px",fontWeight:"bold",fontSize:"0.85rem",cursor:l?"wait":"pointer",opacity:l&&l!=="ban"?.5:1},children:l==="ban"?"Banning...":"Ban from Group"})]})]})]})})})})}),document.body)},V=()=>{const[i,o]=b.useState([]),[r,s]=b.useState(!1),[n,m]=b.useState([]),[y,j]=b.useState(null),l=async()=>{try{const t=await window.electron.automod.getHistory();m(t||[])}catch(t){console.error("Failed to load AutoMod history",t)}},d=async()=>{try{const t=await window.electron.automod.getRules();o(t||[])}catch(t){console.error("Failed to load AutoMod rules",t)}};B.useEffect(()=>{d(),l();const t=(v,T)=>{m(E=>[T,...E].slice(0,50))},g=window.electron.ipcRenderer.on("automod:log",t);return()=>g()},[]);const h=async(t,g)=>{const v=i.find(L=>L.type===t);let T={};t==="KEYWORD_REJECTION"?T={keywords:[],whitelist:[],matchMode:"WHOLE_WORD",scanBio:!0,scanStatus:!0,scanPronouns:!1}:t==="AGE_VERIFICATION"&&(T={autoAcceptVerified:!1});const E={id:v?.id,name:t==="AGE_VERIFICATION"?"Age Verification Firewall":t==="KEYWORD_REJECTION"?"Keyword Text Filter":"Unknown Rule",type:t,enabled:g?v?v.enabled:!0:!v?.enabled,actionType:"REJECT",config:JSON.stringify(g||(v?JSON.parse(v.config||"{}"):T))};await window.electron.automod.saveRule(E),d()},k=i.find(t=>t.type==="AGE_VERIFICATION"),c=k?.enabled,x=i.find(t=>t.type==="KEYWORD_REJECTION"),u=x?.enabled,C=x?JSON.parse(x.config||"{}"):{},S=C.keywords&&C.keywords.length>0,{fetchLogs:I}=P(),{selectedGroup:a,fetchGroupBans:R,fetchGroupMembers:f}=D();return e.jsxs(e.Fragment,{children:[e.jsx(O,{isOpen:r,onClose:()=>s(!1),config:C,onUpdate:t=>h("KEYWORD_REJECTION",t)}),e.jsx(G,{isOpen:y!==null,onClose:()=>j(null),logEntry:y,onActionComplete:()=>{l(),a&&(I(a.id),R(a.id),f(a.id,0))}}),e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},style:{height:"100%",display:"flex",flexDirection:"column",gap:"1.5rem",minHeight:0},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1.5rem",height:"100%",minHeight:0},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem",overflowY:"auto",paddingRight:"8px"},children:[e.jsxs(w,{style:{padding:"1.5rem",borderLeft:"4px solid var(--color-primary)"},children:[e.jsxs("h3",{style:{margin:"0 0 0.5rem",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{width:"8px",height:"8px",background:"#4ade80",borderRadius:"50%",boxShadow:"0 0 10px #4ade80"}}),"Request Firewall"]}),e.jsx("p",{style:{margin:0,color:"var(--color-text-dim)",fontSize:"0.9rem"},children:"Active sorting protocols for incoming group join requests. Requests are pre-scanned before you even see them."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},children:[e.jsxs(p.div,{className:"glass-panel",style:{padding:"1.5rem",height:"auto",minHeight:"180px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",border:c?"1px solid #4ade80":"1px dashed rgba(255,255,255,0.1)",background:c?"rgba(74, 222, 128, 0.05)":"transparent",transition:"border 0.2s ease, box-shadow 0.2s ease",boxShadow:c?"0 0 15px rgba(74, 222, 128, 0.1)":"none",position:"relative"},children:[e.jsxs("div",{style:{cursor:"pointer",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"10px"},onClick:()=>h("AGE_VERIFICATION"),children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:c?"#4ade80":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"1rem",color:c?"black":"white",transition:"background 0.3s"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})})}),e.jsx("div",{style:{fontWeight:"bold",color:c?"#4ade80":"var(--color-text-dim)",transition:"color 0.3s"},children:"18+ Age Verified Only"}),e.jsx("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem",color:c?"#4ade80":"rgba(255,255,255,0.3)",textTransform:"uppercase",letterSpacing:"0.05em"},children:c?"ACTIVE REJECTION":"DISABLED"})]}),c&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},style:{marginTop:"1.5rem",width:"100%",paddingTop:"1rem",borderTop:"1px solid rgba(74, 222, 128, 0.2)"},children:e.jsxs("div",{onClick:t=>{t.stopPropagation();const g=JSON.parse(k?.config||"{}");h("AGE_VERIFICATION",{...g,autoAcceptVerified:!g.autoAcceptVerified})},style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.8rem",color:"rgba(255,255,255,0.8)",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",background:"rgba(0,0,0,0.2)"},children:[e.jsx("span",{children:"Auto-Accept Verified"}),e.jsx("div",{style:{width:"32px",height:"18px",background:JSON.parse(k?.config||"{}").autoAcceptVerified?"#4ade80":"rgba(255,255,255,0.2)",borderRadius:"10px",position:"relative",transition:"background 0.2s"},children:e.jsx("div",{style:{width:"14px",height:"14px",background:"white",borderRadius:"50%",position:"absolute",top:"2px",left:JSON.parse(k?.config||"{}").autoAcceptVerified?"16px":"2px",transition:"left 0.2s"}})})]})})]}),e.jsxs(p.div,{className:"glass-panel",style:{padding:"1.5rem",height:"auto",minHeight:"180px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",border:u?"1px solid #f87171":"1px dashed rgba(255,255,255,0.1)",background:u?"rgba(239, 68, 68, 0.05)":"transparent",transition:"border 0.2s ease, box-shadow 0.2s ease",boxShadow:u?"0 0 15px rgba(239, 68, 68, 0.1)":"none",position:"relative"},children:[e.jsxs("div",{style:{cursor:"pointer",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"10px"},onClick:()=>h("KEYWORD_REJECTION"),children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:u?"#f87171":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"1rem",color:u?"black":"white",transition:"background 0.3s"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),e.jsx("div",{style:{fontWeight:"bold",color:u?"#f87171":"var(--color-text-dim)",transition:"color 0.3s"},children:"Keyword Text Filter"}),e.jsx("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem",color:u?"#f87171":"rgba(255,255,255,0.3)",textTransform:"uppercase",letterSpacing:"0.05em"},children:u?"ACTIVE FILTERING":"DISABLED"})]}),u&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},style:{marginTop:"1.2rem",width:"100%"},children:e.jsx("button",{onClick:t=>{t.stopPropagation(),s(!0)},style:{width:"100%",padding:"8px 0",background:S?"transparent":"#f87171",border:S?"1px solid rgba(248, 113, 113, 0.4)":"none",color:S?"#fca5a5":"black",borderRadius:"6px",fontWeight:"bold",fontSize:"0.8rem",cursor:"pointer",letterSpacing:"0.05em",transition:"all 0.2s",textTransform:"uppercase"},children:S?"Edit Config":"Setup"})})]}),e.jsx(w,{style:{height:"auto",minHeight:"180px",display:"flex",alignItems:"center",justifyContent:"center",border:"1px dashed rgba(255,255,255,0.1)",opacity:.5},children:e.jsx("span",{style:{color:"var(--color-text-dim)",fontStyle:"italic"},children:"More Rules Coming Soon"})})]})]}),e.jsxs(w,{style:{display:"flex",flexDirection:"column",minHeight:0,maxHeight:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.05)",fontWeight:"bold",fontSize:"0.85rem",letterSpacing:"0.05em",flexShrink:0},children:"INTERCEPTION LOG"}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"0",minHeight:0},children:n.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:e.jsx(A,{initial:!1,children:n.map(t=>e.jsxs(p.div,{initial:{opacity:0,x:-20,height:0},animate:{opacity:1,x:0,height:"auto"},onClick:()=>j(t),style:{padding:"10px 1rem",borderBottom:"1px solid rgba(255,255,255,0.05)",fontSize:"0.8rem",cursor:"pointer",transition:"background 0.2s"},whileHover:{backgroundColor:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"white"},children:t.user}),e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.3)"},children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{color:t.action==="BLOCKED"?"#f87171":"#4ade80",fontWeight:"bold",fontSize:"0.7rem"},children:t.action}),e.jsx("span",{style:{color:"var(--color-text-dim)",fontSize:"0.75rem"},children:t.reason})]})]},t.id))})}):e.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-text-dim)",fontSize:"0.8rem",fontFamily:"monospace",padding:"1rem"},children:c||u?e.jsxs("div",{style:{textAlign:"center",opacity:.7},children:[e.jsx("div",{style:{color:"#4ade80",marginBottom:"4px"},children:"● SYSTEM ARMED"}),"Monitoring requests..."]}):"[NO ACTIVE RULES]"})})]})]})})]})},F=()=>e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:e.jsxs(w,{style:{width:"100%",maxWidth:"600px",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{width:"64px",height:"64px",margin:"0 auto 1.5rem",background:"rgba(255,255,255,0.05)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-primary)"},children:e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})})}),e.jsx("h2",{style:{margin:"0 0 0.5rem"},children:"Global Immunity"}),e.jsx("p",{style:{color:"var(--color-text-dim)",marginBottom:"2rem"},children:"Define entities that bypass all security layers (Gatekeeper & Sentinel)."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",textAlign:"left"},children:[e.jsxs("div",{style:{padding:"1rem",background:"rgba(255,255,255,0.03)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:"VIP Users"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-dim)",marginTop:"4px"},children:"Specific usernames"})]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(255,255,255,0.03)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:"Trust Ranks"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-dim)",marginTop:"4px"},children:"System-wide ranks"})]})]})]})}),J=()=>{const[i,o]=b.useState("GATEKEEPER");return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",gap:"1rem",paddingBottom:"20px"},children:[e.jsx("div",{style:{flex:"0 0 auto",display:"flex",justifyContent:"center"},children:e.jsxs(w,{style:{padding:"4px",borderRadius:"12px",display:"flex",background:"rgba(0,0,0,0.4)",backdropFilter:"blur(10px)"},children:[e.jsx(W,{active:i==="GATEKEEPER",label:"GATEKEEPER",icon:e.jsxs("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"})]}),onClick:()=>o("GATEKEEPER")}),e.jsx("div",{style:{width:"1px",background:"rgba(255,255,255,0.1)",margin:"8px 0"}}),e.jsx(W,{active:i==="IMMUNITY",label:"IMMUNITY",icon:e.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),onClick:()=>o("IMMUNITY")})]})}),e.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden",minHeight:0},children:e.jsxs(A,{mode:"wait",children:[i==="GATEKEEPER"&&e.jsx(p.div,{style:{height:"100%"},children:e.jsx(V,{})},"gatekeeper"),i==="IMMUNITY"&&e.jsx(p.div,{style:{height:"100%"},children:e.jsx(F,{})},"immunity")]})})]})};export{J as AutoModView};
