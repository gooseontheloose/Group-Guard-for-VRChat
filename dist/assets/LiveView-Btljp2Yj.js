import{r as d,u as P,j as e,M as J,G as z,N as u,m as $,c as ne,A as H}from"./index-D5E0sjoJ.js";const oe=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),le=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,o,g)=>g?g.toUpperCase():o.toLowerCase()),K=i=>{const n=le(i);return n.charAt(0).toUpperCase()+n.slice(1)},Q=(...i)=>i.filter((n,o,g)=>!!n&&n.trim()!==""&&g.indexOf(n)===o).join(" ").trim(),ae=i=>{for(const n in i)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};var ce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const de=d.forwardRef(({color:i="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:g,className:x="",children:a,iconNode:k,...c},C)=>d.createElement("svg",{ref:C,...ce,width:n,height:n,stroke:i,strokeWidth:g?Number(o)*24/Number(n):o,className:Q("lucide",x),...!a&&!ae(c)&&{"aria-hidden":"true"},...c},[...k.map(([p,f])=>d.createElement(p,f)),...Array.isArray(a)?a:[a]]));const v=(i,n)=>{const o=d.forwardRef(({className:g,...x},a)=>d.createElement(de,{ref:a,iconNode:n,className:Q(`lucide-${oe(K(i))}`,`lucide-${i}`,g),...x}));return o.displayName=K(i),o};const pe=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],xe=v("activity",pe);const he=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Y=v("check",he);const ge=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],me=v("copy",ge);const ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],ue=v("crosshair",ye);const fe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],q=v("external-link",fe);const ve=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],_=v("gavel",ve);const je=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],be=v("loader-circle",je);const ke=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],we=v("radio",ke);const Ce=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],T=v("shield-alert",Ce);const Se=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Z=v("shield-check",Se);const Ie=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],O=v("user-plus",Ie);const Ne=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ze=v("user",Ne);const Me=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Re=v("users",Me);const Ee=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ae=v("x",Ee),De=({isOpen:i,onClose:n,userId:o,onInvite:g,onKick:x,onBan:a})=>{const{selectedGroup:k}=P(),[c,C]=d.useState(null),[p,f]=d.useState(!1),[I,w]=d.useState(null);d.useEffect(()=>{i&&o?M(o):(C(null),w(null))},[i,o]);const M=async s=>{f(!0),w(null);try{if(window.electron?.getUser){const y=await window.electron.getUser(s);if(y.success&&y.user){const h=y.user;C({id:h.id,displayName:h.displayName,description:h.bio||"",tags:h.tags||[],thumbnailUrl:h.userIcon||h.profilePicOverride||h.currentAvatarThumbnailImageUrl||"",currentAvatarImageUrl:h.currentAvatarImageUrl||"",status:h.status||"offline",statusDescription:h.statusDescription||"",last_login:h.last_login||"",developerType:h.developerType||"none",isFriend:h.isFriend||!1})}else w(y.error||"Failed to fetch profile")}else w("Profile fetch not implemented in this version (API missing)")}catch(y){w("Failed to load profile"),console.error(y)}finally{f(!1)}},A=()=>{o&&navigator.clipboard.writeText(o)},S=()=>{o&&window.open(`https://vrchat.com/home/user/${o}`,"_blank")};return i?e.jsx(J,{isOpen:i,onClose:n,title:"User Profile",children:e.jsx("div",{style:{minWidth:"500px",maxWidth:"800px",minHeight:"300px",display:"flex",flexDirection:"column",gap:"1.5rem"},children:p?e.jsxs("div",{style:{padding:"3rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem",color:"var(--color-text-dim)"},children:[e.jsx(be,{className:"animate-spin",size:32}),e.jsx("span",{children:"Fetching VRChat Data..."})]}):I?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"#fca5a5"},children:[e.jsx(T,{size:32,style:{marginBottom:"1rem"}}),e.jsx("div",{children:I}),e.jsxs("div",{style:{fontSize:"0.8rem",marginTop:"0.5rem",opacity:.7},children:["User ID: ",o]})]}):c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"12px",overflow:"hidden",border:"2px solid var(--color-primary)",background:"rgba(0,0,0,0.3)",flexShrink:0},children:e.jsx("img",{src:c.currentAvatarImageUrl||c.thumbnailUrl,alt:c.displayName,style:{width:"100%",height:"100%",objectFit:"cover"},onError:s=>s.currentTarget.style.display="none"})}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.8rem",fontWeight:800},children:c.displayName}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold",background:c.status==="active"?"var(--color-success)":"rgba(255,255,255,0.1)",color:c.status==="active"?"black":"white"},children:c.status.toUpperCase()})]}),e.jsx("div",{style:{display:"flex",gap:"10px",fontSize:"0.8rem",color:"var(--color-text-dim)"},children:c.developerType!=="none"&&e.jsx("span",{style:{color:"#fcd34d"},children:"Verified Creator"})}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"8px 12px",borderRadius:"6px",fontFamily:"monospace",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"10px",marginTop:"auto"},children:[e.jsx("span",{style:{opacity:.7},children:"ID:"}),e.jsx("span",{style:{userSelect:"all"},children:c.id}),e.jsx("button",{onClick:A,title:"Copy ID",style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:0},children:e.jsx(me,{size:14})}),e.jsx("button",{onClick:S,title:"Open on VRChat.com",style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:0,marginLeft:"auto"},children:e.jsx(q,{size:14})})]})]})]}),c.description&&e.jsx(z,{style:{padding:"1rem",fontSize:"0.9rem",lineHeight:"1.5",color:"rgba(255,255,255,0.9)",maxHeight:"100px",overflowY:"auto"},children:c.description}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"auto"},children:k?e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"secondary",onClick:()=>g(c.id,c.displayName),children:[e.jsx(O,{size:18}),"INVITE TO GROUP"]}),e.jsxs(u,{variant:"danger",onClick:()=>a(c.id,c.displayName),children:[e.jsx(_,{size:18}),"BAN MANAGER"]}),e.jsxs(u,{variant:"danger",style:{gridColumn:"span 2"},onClick:()=>x(c.id,c.displayName),children:[e.jsx(T,{size:18}),"KICK FROM INSTANCE"]})]}):e.jsx("div",{style:{gridColumn:"span 2",textAlign:"center",padding:"1rem",color:"var(--color-text-dim)",fontSize:"0.9rem",fontStyle:"italic"},children:"Select a group to perform moderation actions."})})]}):e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx(ze,{size:48,style:{opacity:.2,marginBottom:"1rem"}}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"0.5rem"},children:"User Profile"}),e.jsx("div",{style:{fontFamily:"monospace",background:"rgba(0,0,0,0.3)",padding:"0.5rem",borderRadius:"4px",display:"inline-block"},children:o||"No ID Provided"}),e.jsx("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"center",gap:"1rem"},children:e.jsxs(u,{variant:"secondary",onClick:S,children:[e.jsx(q,{size:16})," Open on VRChat.com"]})})]})})}):null},Te=({isOpen:i,onClose:n,user:o,initialGroupId:g})=>{const{myGroups:x}=P(),[a,k]=d.useState(()=>{const s=new Set;return g&&s.add(g),s}),[c,C]=d.useState(!1),[p,f]=d.useState(null),[I,w]=d.useState([]),M=s=>{const y=new Set(a);y.has(s)?y.delete(s):y.add(s),k(y)},A=()=>{a.size===x.length?k(new Set):k(new Set(x.map(s=>s.id)))},S=async()=>{if(!o||a.size===0||!confirm(`Are you sure you want to BAN ${o.displayName} from ${a.size} groups? This cannot be easily undone.`))return;if(!window.electron.banUser){alert(`CRITICAL ERROR: 'banUser' function is missing.

Please RESTART the application to apply the latest updates.`);return}C(!0),w([]);const s=x.filter(l=>a.has(l.id));f({current:0,total:s.length,failed:0});let y=0,h=0;const N=[];for(const l of s){try{const j=await window.electron.banUser(l.id,o.id);N.push({groupId:l.id,groupName:l.name,success:j.success,error:j.error}),j.success||h++}catch(j){const U=j instanceof Error?j.message:"Unknown error";N.push({groupId:l.id,groupName:l.name,success:!1,error:U}),h++}y++,f({current:y,total:s.length,failed:h}),w([...N]),await new Promise(j=>setTimeout(j,200))}C(!1)};return o?e.jsx(J,{isOpen:i,onClose:c?()=>{}:n,title:`Ban User: ${o.displayName}`,children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",minWidth:"400px",maxHeight:"70vh"},children:p?e.jsxs("div",{style:{textAlign:"center",padding:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem",display:"flex",flexDirection:"column",gap:"5px"},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:p.current<p.total?"Banning User...":"Ban Operation Complete"}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--color-text-dim)"},children:[p.current," / ",p.total," Processed • ",p.failed," Failed"]})]}),e.jsx("div",{style:{height:"8px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",marginBottom:"1.5rem",overflow:"hidden"},children:e.jsx($.div,{initial:{width:0},animate:{width:`${p.current/p.total*100}%`},style:{height:"100%",background:"var(--color-danger)"}})}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",textAlign:"left",display:"flex",flexDirection:"column",gap:"6px"},children:I.map(s=>e.jsxs("div",{style:{fontSize:"0.8rem",display:"flex",justifyContent:"space-between",padding:"6px",background:"rgba(0,0,0,0.2)",borderRadius:"4px"},children:[e.jsx("span",{children:s.groupName}),s.success?e.jsxs("span",{style:{color:"var(--color-success)",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Y,{size:12})," Banned"]}):e.jsxs("span",{style:{color:"#fca5a5",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Ae,{size:12})," ",s.error]})]},s.groupId))}),p.current===p.total&&e.jsx("div",{style:{marginTop:"1.5rem"},children:e.jsx(u,{onClick:n,style:{width:"100%"},children:"Close"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(z,{style:{padding:"1rem",background:"rgba(255,50,50,0.1)",border:"1px solid rgba(255,50,50,0.3)",display:"flex",gap:"10px",alignItems:"center"},children:[e.jsx(T,{size:24,color:"#fca5a5"}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"#fca5a5"},children:[e.jsx("b",{children:"Warning:"})," You are about to ban ",e.jsx("b",{children:o.displayName}),". Select the groups to apply this ban to."]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"-5px"},children:[e.jsxs("h4",{style:{margin:0,color:"var(--color-text-dim)"},children:["Select Groups (",a.size,")"]}),e.jsx("button",{onClick:A,style:{background:"none",border:"none",color:"var(--color-primary)",cursor:"pointer",fontSize:"0.8rem",fontWeight:"bold"},children:a.size===x.length?"Deselect All":"Select All"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",overflowY:"auto",paddingRight:"5px",maxHeight:"300px"},children:x.map(s=>e.jsxs("div",{onClick:()=>M(s.id),style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:a.has(s.id)?"rgba(var(--primary-hue), 100%, 50%, 0.15)":"rgba(255,255,255,0.03)",border:a.has(s.id)?"1px solid var(--color-primary)":"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"4px",border:a.has(s.id)?"none":"2px solid rgba(255,255,255,0.3)",background:a.has(s.id)?"var(--color-primary)":"transparent",display:"flex",alignItems:"center",justifyContent:"center"},children:a.has(s.id)&&e.jsx(Y,{size:12,color:"black",strokeWidth:4})}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:a.has(s.id)?600:400},children:s.name}),s.shortCode&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)",marginLeft:"auto"},children:s.shortCode})]},s.id))}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"1rem"},children:[e.jsx(u,{variant:"secondary",onClick:n,style:{flex:1},children:"Cancel"}),e.jsxs(u,{variant:"danger",onClick:S,disabled:a.size===0,style:{flex:1,gap:"8px"},children:[e.jsx(_,{size:18}),"BAN FROM ",a.size," GROUPS"]})]})]})})}):null},X=({entity:i,onInvite:n,onKick:o,onBan:g,readOnly:x,onClick:a})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.05)",borderRadius:"8px",marginBottom:"8px",transition:"background 0.2s"},children:[e.jsxs("div",{onClick:()=>a(i),style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:!x&&i.isGroupMember?"rgba(var(--primary-hue), 100%, 50%, 0.2)":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:!x&&i.isGroupMember?"var(--color-primary)":"var(--color-text-dim)",overflow:"hidden"},children:i.avatarUrl?e.jsx("img",{src:i.avatarUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(Re,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"white",textDecoration:"underline",textDecorationColor:"rgba(255,255,255,0.2)"},children:i.displayName}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)",display:"flex",gap:"6px",alignItems:"center"},children:x?e.jsx("span",{children:"Detected User"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:i.isGroupMember?"var(--color-primary)":"#fca5a5",fontWeight:"bold"},children:i.isGroupMember?"MEMBER":"NON-MEMBER"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:i.rank})]})})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[!x&&!i.isGroupMember&&e.jsx(u,{size:"sm",variant:"secondary",style:{padding:"4px 8px",fontSize:"0.75rem"},onClick:()=>n(i.id,i.displayName),title:"Invite to Group",children:e.jsx(O,{size:14})}),e.jsx(u,{size:"sm",variant:"danger",style:{padding:"4px 8px",fontSize:"0.75rem",opacity:x?.8:1},onClick:()=>g(i.id,i.displayName),title:"Ban Manager",children:e.jsx(_,{size:14})}),!x&&e.jsx(u,{size:"sm",variant:"danger",style:{padding:"4px 8px",fontSize:"0.75rem"},onClick:()=>o(i.id,i.displayName),title:"Kick from Instance",children:e.jsx(T,{size:14})})]})]}),Le=()=>{const{selectedGroup:i,isRoamingMode:n}=P(),{currentWorldName:o,currentWorldId:g,instanceImageUrl:x,liveScanResults:a,updateLiveScan:k,setEntityStatus:c}=ne(),[C]=d.useState(!0),p=a,[f,I]=d.useState(null),[w,M]=d.useState([]),[A,S]=d.useState(!1),[s,y]=d.useState(null),[h,N]=d.useState(null),l=d.useCallback((t,r="info")=>{M(m=>[...m.slice(-49),{message:t,type:r,id:Date.now()+Math.random()}])},[]),j=(t,r)=>{y({id:t,displayName:r})},U=t=>{N({id:t.id,displayName:t.displayName})},G=d.useCallback(async()=>{if(!(!i&&!n))try{const t=i?i.id:void 0,r=await window.electron.instance.scanSector(t);if(k(r),window.electron.instance.getInstanceInfo){const m=await window.electron.instance.getInstanceInfo();m.success&&I({name:m.name||o||"Unknown",imageUrl:m.imageUrl||x||void 0,worldId:m.worldId||g||void 0,instanceId:m.instanceId||void 0})}else I({name:o||"Unknown",imageUrl:x||void 0,worldId:g||void 0,instanceId:void 0})}catch(t){console.error(t)}},[i,n,o,g,x,k]);d.useEffect(()=>{if(!i&&!n)return;i?l(`[SYSTEM] Uplink established to ${i.name}.`,"success"):M(r=>{const m=r[r.length-1];return m&&m.message.includes("ROAMING MODE ENGAGED")?r:[...r.slice(-49),{message:"[SYSTEM] ROAMING MODE ENGAGED. Passive Monitoring Active.",type:"warn",id:Date.now()}]}),G();const t=setInterval(G,5e3);return()=>clearInterval(t)},[i,n,G,l]),d.useEffect(()=>window.electron.instance.onEntityUpdate(r=>{l(`[SCAN] Profile Resolved: ${r.displayName} (Rank: ${r.rank})`,"info")}),[l]);const W=async(t,r)=>{if(i){l(`[CMD] Inviting ${r}...`,"info");try{await window.electron.instance.recruitUser(i.id,t),l(`[CMD] Invite sent to ${r}`,"success")}catch{l(`[CMD] Failed to invite ${r}`,"error")}}},F=async(t,r)=>{if(i&&confirm(`Are you sure you want to KICK (Vote/Ban) ${r}?`)){l(`[CMD] Kicking ${r}...`,"warn");try{await window.electron.instance.kickUser(i.id,t),l(`[CMD] Kicked ${r}`,"success"),c(t,"kicked")}catch{l(`[CMD] Failed to kick ${r}`,"error")}}},[b,R]=d.useState(null),[V,L]=d.useState(null),ee=async()=>{if(!p.length)return;const t=p.filter(m=>!m.isGroupMember&&m.status==="active");if(t.length===0){l("[CMD] No strangers to recruit.","warn");return}l(`[CMD] SENDING MASS INVITES TO ${t.length} STRANGERS...`,"warn"),R({current:0,total:t.length}),L("recruit");let r=0;for(const m of t){const D=await window.electron.instance.recruitUser(i.id,m.id);!D.success&&D.error==="RATE_LIMIT"&&(l("[WARN] RATE LIMIT DETECTED! Cooling down for 10s...","warn"),await new Promise(E=>setTimeout(E,1e4))),r++,R({current:r,total:t.length}),await new Promise(E=>setTimeout(E,250))}l(`[CMD] Recruitment complete. Sent ${r} invites.`,"success"),R(null),L(null)},te=async()=>{if(i){l("[CMD] Fetching rally targets...","info"),S(!0);try{const t=await window.electron.instance.getRallyTargets(i.id);if(S(!1),!t.success||!t.targets||t.targets.length===0){l("[CMD] No rally targets found (recent members).","warn");return}const r=t.targets;l(`[CMD] RALLYING ${r.length} GROUP MEMBERS...`,"warn"),R({current:0,total:r.length}),L("rally");let m=0;for(const D of r){if(!D.id)continue;const E=await window.electron.instance.inviteToCurrent(D.id);!E.success&&E.error==="RATE_LIMIT"&&(l("[WARN] RATE LIMIT DETECTED! Cooling down for 10s...","warn"),await new Promise(B=>setTimeout(B,1e4))),m++,R({current:m,total:r.length}),await new Promise(B=>setTimeout(B,250))}l(`[CMD] Rally complete. Sent ${m} invites.`,"success")}catch{l("[CMD] Rally error","error")}finally{S(!1),R(null),L(null)}}},ie=()=>{if(b&&V==="recruit"){const t=Math.round(b.current/b.total*100);return e.jsxs(u,{disabled:!0,style:{flex:1,height:"60px",flexDirection:"column",gap:"4px",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:`${t}%`,background:"rgba(var(--primary-hue), 100%, 50%, 0.3)",transition:"width 0.2s linear"}}),e.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:[t,"%"]}),e.jsxs("span",{style:{fontSize:"0.65rem",opacity:.8},children:[b.current,"/",b.total," SENT"]})]})]})}return e.jsxs(u,{onClick:ee,disabled:b!==null,style:{flex:1,height:"60px",flexDirection:"column",gap:"4px"},children:[e.jsx(O,{size:20}),e.jsx("span",{style:{fontSize:"0.75rem"},children:"INVITE INSTANCE TO GROUP"})]})},se=()=>{if(!i)return e.jsxs(u,{disabled:!0,variant:"secondary",style:{flex:1,height:"60px",flexDirection:"column",gap:"4px",opacity:.5},children:[e.jsx(Z,{size:20}),e.jsx("span",{style:{fontSize:"0.75rem"},children:"GROUP OFF-LINE"})]});if(b&&V==="rally"){const t=Math.round(b.current/b.total*100);return e.jsxs(u,{disabled:!0,variant:"secondary",style:{flex:1,height:"60px",flexDirection:"column",gap:"4px",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:`${t}%`,background:"rgba(255, 255, 255, 0.2)",transition:"width 0.2s linear"}}),e.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:"bold"},children:[t,"%"]}),e.jsxs("span",{style:{fontSize:"0.65rem",opacity:.8},children:[b.current,"/",b.total," SENT"]})]})]})}return e.jsxs(u,{onClick:te,disabled:A||b!==null,variant:"secondary",style:{flex:1,height:"60px",flexDirection:"column",gap:"4px"},children:[e.jsx(Z,{size:20}),e.jsx("span",{style:{fontSize:"0.75rem"},children:"INVITE GROUP HERE"})]})},re=async()=>{if(confirm(`⚠️ DANGER ZONE ⚠️

Are you sure you want to CLOSE this instance?

This will kick ALL players (including you) and lock the instance. This cannot be undone.`)){l("[CMD] INITIATING INSTANCE LOCKDOWN...","warn");try{const t=await window.electron.instance.closeInstance();t.success?l("[CMD] Instance Closed Successfully.","success"):l(`[CMD] Failed to close instance: ${t.error}`,"error")}catch{l("[CMD] Lockdown failed. API Error.","error")}}};return e.jsxs("div",{style:{height:"100%",display:"flex",gap:"1rem",overflow:"hidden",paddingBottom:"20px"},children:[e.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:"1rem",minWidth:"500px"},children:[e.jsxs(z,{style:{flex:"0 0 auto",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",overflow:"hidden",position:"relative"},children:[f?.imageUrl&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`url(${f.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center",opacity:.2,filter:"blur(2px)",zIndex:0}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{position:"relative"},children:[f?.imageUrl?e.jsx("img",{src:f.imageUrl,style:{width:"40px",height:"40px",borderRadius:"8px",border:"1px solid var(--color-primary)",objectFit:"cover"}}):e.jsx(we,{className:"text-primary",size:24}),C&&e.jsx($.div,{style:{position:"absolute",inset:-4,border:"2px solid var(--color-primary)",borderRadius:f?.imageUrl?"12px":"50%"},animate:{opacity:[0,1,0],scale:[1,1.2,1.4]},transition:{duration:2,repeat:1/0}})]}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.1rem",fontWeight:800},children:f?.name||"CURRENT INSTANCE"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-dim)",letterSpacing:"0.05em"},children:"LIVE SECTOR SCAN"})]})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",gap:"1rem",overflow:"hidden"},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs(z,{style:{flex:"0 0 auto",padding:"0.8rem 1rem",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--color-success)",boxShadow:"0 0 8px var(--color-success)"}}),e.jsx("h3",{style:{margin:0,fontSize:"0.95rem",color:"white",fontWeight:700,letterSpacing:"0.05em"},children:"IN INSTANCE"}),e.jsx("div",{style:{marginLeft:"auto",fontSize:"0.75rem",color:"var(--color-text-dim)",fontWeight:600},children:p.filter(t=>t.status==="active"||t.status==="joining").length})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",paddingRight:"4px"},children:[e.jsx(H,{children:p.filter(t=>t.status==="active"||t.status==="joining").map(t=>e.jsx($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},children:e.jsx(X,{entity:t,onInvite:W,onKick:F,onBan:j,readOnly:n,onClick:U})},t.id))}),p.filter(t=>t.status==="active"||t.status==="joining").length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--color-text-dim)"},children:["No active entities.",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem"},children:"(Instance is empty)"})]}),e.jsx("div",{style:{height:"20px"}})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs(z,{style:{flex:"0 0 auto",padding:"0.8rem 1rem",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--color-text-dim)"}}),e.jsx("h3",{style:{margin:0,fontSize:"0.95rem",color:"var(--color-text-dim)",fontWeight:700},children:"RECENTLY LEFT"}),e.jsx("div",{style:{marginLeft:"auto",fontSize:"0.75rem",color:"var(--color-text-dim)",fontWeight:600},children:p.filter(t=>t.status==="left"||t.status==="kicked").length})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",paddingRight:"4px"},children:[e.jsx(H,{children:p.filter(t=>t.status==="left"||t.status==="kicked").length===0?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"rgba(255,255,255,0.2)",fontSize:"0.8rem",fontStyle:"italic"},children:"History empty"}):p.filter(t=>t.status==="left"||t.status==="kicked").map(t=>e.jsx($.div,{initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},children:e.jsx(X,{entity:t,onInvite:()=>{},onKick:()=>{},onBan:j,readOnly:!0,onClick:U})},t.id))}),e.jsx("div",{style:{height:"20px"}})]})]})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem",minWidth:"280px"},children:[e.jsxs(z,{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"0.9rem",color:"var(--color-text-dim)",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"0.5rem",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ue,{size:16}),n?"ROAMING CONTROLS":"INSTANCE ACTIONS"]}),n?e.jsx("div",{style:{padding:"1.5rem",textAlign:"center",opacity:.5,fontSize:"0.8rem",border:"1px dashed rgba(255,255,255,0.2)",borderRadius:"8px",background:"rgba(0,0,0,0.1)"},children:"Local Monitoring Active"}):e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[ie(),se()]}),e.jsxs(u,{onClick:re,variant:"danger",style:{width:"100%",height:"40px",fontSize:"0.8rem",opacity:.8},children:[e.jsx(T,{size:16,style:{marginRight:"8px"}}),"CLOSE INSTANCE"]})]})]}),e.jsxs(z,{style:{flex:1,display:"flex",flexDirection:"column",background:"rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{padding:"0.8rem 1rem",borderBottom:"1px solid rgba(255,255,255,0.05)",fontSize:"0.8rem",fontWeight:"bold",color:"var(--color-text-dim)",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(xe,{size:14}),"SYSTEM FEED"]}),e.jsxs("div",{style:{flex:1,padding:"1rem",fontFamily:"monospace",fontSize:"0.8rem",color:"rgba(255,255,255,0.7)",overflowY:"auto",display:"flex",flexDirection:"column",gap:"6px"},children:[w.map(t=>e.jsx("div",{style:{color:t.type==="error"?"#fca5a5":t.type==="success"?"#86efac":t.type==="warn"?"#fde047":"inherit"},children:t.message},t.id)),e.jsx("div",{style:{marginTop:"auto",display:"flex",alignItems:"center",gap:"4px"},children:e.jsx("span",{style:{width:"6px",height:"12px",background:"var(--color-primary)",display:"block",animation:"blink 1s infinite"}})})]})]})]}),e.jsx(Te,{isOpen:!!s,onClose:()=>y(null),user:s,initialGroupId:i?.id},s?s.id:"closed"),e.jsx(De,{isOpen:!!h,onClose:()=>N(null),userId:h?.id,onInvite:(t,r)=>{W(t,r)},onKick:(t,r)=>{F(t,r)},onBan:(t,r)=>{N(null),j(t,r)}},h?h.id:"profile-closed")]})};export{Le as LiveView};
